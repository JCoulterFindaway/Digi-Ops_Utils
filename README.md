# Digi-Ops_Utils
Repo to house utility scripts I use for Digi-ops

Explanation of processes:

New York Times Best Sellers Digital:<br>
Report generated every Monday and emailed to a few individuals, Nyt bestseller date field in TRAP is updated.

Goal of process is to identify audiobooks in our system that are on the NYT Best Sellers List in specific categories.
Running `NYT_API_Best_Sellers.ipynb` returns a csv that includes the current week's Best Sellers in specific categories. I use these results to set up a Vlookup against the historical accumulation of the reports generated by this process. To find any new books that are not on the accumulated historical list, I manually search Gateway using Title and Author to find matches in our system. Once I have a complete report for the current week I email the report to Lauren Greve <lgreve@spotify.com>, Annie Pritchard <anniep@spotify.com>, Jamie Belardo <jamieb@spotify.com>. 
For each title in the new list, it is necessary to update the `Nyt bestseller date` field to the new date for each title in TRAP. To do this I take the list of Content IDs from the current Best Sellers List and run a SQL query on `findaway-etl-data-ingestion.trap_prod.audiobook_{date}` to find the corresponding TRAP Ids. I use the TRAP Ids to create an import to update `Nyt bestseller date` for each title in TRAP to the date displayed on https://www.nytimes.com/books/best-sellers/ (this date is always the following Sunday).





Awards update:<br>
Awards are updated every two weeks generally on Monday

From Looker report TRAP - Audiobook Historical Changes https://lookerstudio.google.com/u/0/reporting/a7051785-b13d-470e-9e31-4fb813bb69f0/page/5LjRD
I export all publisher provided awards for the prior two weeks. I use this report in `Awards_TRAP.ipynb` to filter the results to only the awards we are tracking.
`Awards_TRAP.ipynb` also uses the id lists from the prior two weeks of NYT Best Sellers; NYT Best Sellers is considered an award but most publishers don't provide this via ONIX.
Using the combined list of filtered awards and NYT best sellers, I compare the results to what is in TRAP to identify the titles that need to be updated.
I then look up the TRAP Ids via SQL query in `findaway-etl-data-ingestion.trap_prod.audiobook_{date}` to find the TRAP IDS to then create an import for TRAP to make the appropriate updates to the "Awards" field for each title










